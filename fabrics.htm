<div class="header">
    <div class="title">Manage <span data-bind="pageTitle"></span></div>
    <div class="bread">Ziti Network <span class="secondary">/</span> Manage <span data-bind="pageTitle"></span></div>
    <div class="line"></div>
    <div class="tabs">
      <div class="tab selected">Manage <span data-bind="pageTitle"></span></div>
    </div>
</div>
<div class="action icon-plus"></div>
<div class="filters data">
    <input id="SearchFilter" type="text" class="search" placeholder="Type to Filter" />
    <div class="counters">1-23 of 23</div>
    <div class="navigate prev icon-prev disabled"></div>
    <div class="navigate next icon-next disabled"></div>
</div>
<div class="area data">
    <div class="table">
        <div class="head grid four">
            <div class="col">
                <div class="selector"></div>
            </div>
            <div class="col">Name<div class="dragger"></div></div>
            <div class="col">Created</div>
            <div class="dots"></div>
        </div>
        <div class="rows">
            <!-- This area will be replaced by data rows -->
        </div>
    </div>
</div>
<div class="nodata">No <span data-bind="pageTitle"></span> Defined, Click the plus to add A <span data-bind="singular"></span>.</div>

<div id="RowTemplate" class="row grid four template">
    <div class="col">
        <div class="selector" data-id="{{id}}"></div>
    </div>
    <div class="col"><strong>{{name}}</strong></div>
    <div class="col">{{createdAt}}</div>
    <div class="col allowOver">
        <div class="dots" data-id="{{id}}">...
            <div class="menu" data-id="{{id}}">
                <div class="action edit" data-id="{{id}}">Edit</div>
                <div class="action delete" data-id="{{id}}">Delete</div>
            </div>
        </div>
    </div>
</div>


<script language="javascript" type="text/javascript">
    page = {
        binding: {
            pageTitle: "Fabric Services",
            singular: "Fabric Service"
        },
        data: [],
        init: function() {
            this.events();
            context.addListener(fabrics.name, page.getLoaded);
            fabrics.get();
        }, 
        events: function() {
        },
        getLoaded: function(e) {
            page.data = fabrics.data;
            $(".rows").html("");
                if (fabrics.data.length>0) {
                for (var i=0; i<fabrics.data.length; i++) {
                    var element = $("#RowTemplate").clone();
                    element.removeClass("template");
                    element.attr("id","Row"+i);
                    element.html(element.html().split("{{id}}").join(fabrics.data[i].id));
                    element.html(element.html().split("{{name}}").join(fabrics.data[i].name));
                    element.html(element.html().split("{{createdAt}}").join(moment(fabrics.data[i].createdAt).fromNow()));
                    $(".rows").append(element);
                }
                page.pageLoaded();     
                $(".data").show();
                $(".nodata").hide();       
            } else {
                $(".data").hide();
                $(".nodata").show();
            }       
        },
        pageLoaded: function() {
            app.postLoad();
        }
    }
</script>